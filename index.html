<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Portal - Salokhiddin Makhmudov</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 25%, #f5f5f5 50%, #f5f5f5 100%);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
            color: #333;
            position: relative;
            overflow-x: hidden;
        }

        .header {
            background-color: #2e8b57;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            flex-wrap: wrap;
            position: relative;
            z-index: 10;
        }

        .name, .id {
            font-size: 2.5rem;
            font-weight: bold;
        }

        .grade-box {
            background-color: white;
            padding: 10px 15px;
            border-radius: 8px;
            color: #2e8b57;
            font-weight: bold;
            font-size: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: right;
            min-width: 140px;
        }

        .grade-box small {
            font-weight: normal;
            color: #555;
            font-size: 0.8rem;
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.05);
            position: relative;
            z-index: 10;
        }

        .section-title {
            font-size: 1.8rem;
            color: #2e8b57;
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        .assignments {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .assignment-card {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
        }

        .assignment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .assignment-card h3 {
            margin-top: 0;
            margin-bottom: 10px;
        }

        .assignment-subtitle {
            font-weight: 600;
            color: #666;
            margin-bottom: 15px;
        }

        .script-title {
            font-weight: bold;
            color: #2e8b57;
            font-size: 1.1rem;
            margin: 10px 0;
        }

        .button-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: auto;
        }

        .action-button {
            background-color: #2e8b57;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s ease;
            text-decoration: none;
            display: inline-block;
            width: 100%;
        }

        .action-button:hover {
            background-color: #3ca370;
        }

        .chatgpt-button {
            background-color: #10a37f;
        }

        .chatgpt-button:hover {
            background-color: #0d8a6b;
        }

        .ai-tutor-button {
            background-color: #7c3aed;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.3);
            margin-bottom: 20px;
        }

        .ai-tutor-button:hover {
            background-color: #6d28d9;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(124, 58, 237, 0.4);
        }

        .reflection-button {
            background-color: #f59e0b;
        }

        .reflection-button:hover {
            background-color: #d97706;
        }

        .uncompleted {
            background-color: #fff8e6;
            border: 1px dashed #d4a017;
        }

        .google-folder-container {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }

        .google-folder-button {
            background-color: #4285F4;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .google-folder-button:hover {
            background-color: #3367D6;
        }

        .ai-tutor-section {
            text-align: center;
            margin-top: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .ai-tutor-section h2 {
            color: white;
            margin-bottom: 20px;
            font-size: 1.8rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .ai-tutor-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .animated-element {
            width: 100px;
            height: 100px;
            background: linear-gradient(45deg, #2e8b57, #87ceab);
            border-radius: 50%;
            margin: 40px auto;
            animation: pulse 2s infinite alternate;
            box-shadow: 0 0 10px rgba(46, 139, 87, 0.5);
        }

        @keyframes pulse {
            0% {
                transform: scale(1) rotate(0deg);
                box-shadow: 0 0 10px rgba(46, 139, 87, 0.5);
            }
            100% {
                transform: scale(1.1) rotate(360deg);
                box-shadow: 0 0 20px rgba(46, 139, 87, 0.8);
            }
        }

        /* Background Planet Animations */
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .planet-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .planet {
            position: absolute;
            border-radius: 50%;
            opacity: 0.6;
        }

        .planet1 {
            width: 80px;
            height: 80px;
            background: radial-gradient(circle at 30% 30%, #ff6b6b, #ee5a24);
            top: 10%;
            left: -80px;
            animation: moveAcross 25s linear infinite;
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.3);
        }

        .planet2 {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle at 30% 30%, #74b9ff, #0984e3);
            top: 30%;
            right: -60px;
            animation: moveAcrossReverse 30s linear infinite;
            box-shadow: 0 0 15px rgba(116, 185, 255, 0.3);
        }

        .planet3 {
            width: 70px;
            height: 70px;
            background: radial-gradient(circle at 30% 30%, #fd79a8, #e84393);
            top: 60%;
            left: -70px;
            animation: moveAcross 35s linear infinite;
            box-shadow: 0 0 18px rgba(253, 121, 168, 0.3);
        }

        .planet4 {
            width: 55px;
            height: 55px;
            background: radial-gradient(circle at 30% 30%, #fdcb6e, #e17055);
            top: 80%;
            right: -55px;
            animation: moveAcrossReverse 28s linear infinite;
            box-shadow: 0 0 12px rgba(253, 203, 110, 0.3);
        }

        .planet5 {
            width: 65px;
            height: 65px;
            background: radial-gradient(circle at 30% 30%, #a29bfe, #6c5ce7);
            top: 20%;
            left: -65px;
            animation: moveAcross 40s linear infinite;
            box-shadow: 0 0 16px rgba(162, 155, 254, 0.3);
        }

        .planet6 {
            width: 75px;
            height: 75px;
            background: radial-gradient(circle at 30% 30%, #55efc4, #00b894);
            top: 50%;
            right: -75px;
            animation: moveAcrossReverse 32s linear infinite;
            box-shadow: 0 0 20px rgba(85, 239, 196, 0.3);
        }

        @keyframes moveAcross {
            0% {
                transform: translateX(0) translateY(0) rotate(0deg);
            }
            25% {
                transform: translateX(25vw) translateY(-20px) rotate(90deg);
            }
            50% {
                transform: translateX(50vw) translateY(20px) rotate(180deg);
            }
            75% {
                transform: translateX(75vw) translateY(-10px) rotate(270deg);
            }
            100% {
                transform: translateX(calc(100vw + 80px)) translateY(0) rotate(360deg);
            }
        }

        @keyframes moveAcrossReverse {
            0% {
                transform: translateX(0) translateY(0) rotate(0deg);
            }
            25% {
                transform: translateX(-25vw) translateY(15px) rotate(-90deg);
            }
            50% {
                transform: translateX(-50vw) translateY(-25px) rotate(-180deg);
            }
            75% {
                transform: translateX(-75vw) translateY(10px) rotate(-270deg);
            }
            100% {
                transform: translateX(calc(-100vw - 80px)) translateY(0) rotate(-360deg);
            }
        }

        /* Butterfly Canvas Background */
        .butterfly-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            opacity: 0.7;
        }

        /* Modal styles for embedded content */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
        }

        .modal-content {
            position: relative;
            background-color: #fefefe;
            margin: 2% auto;
            padding: 0;
            border: none;
            width: 95%;
            height: 90%;
            border-radius: 8px;
            overflow: hidden;
        }

        .modal-header {
            background-color: #2e8b57;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .close {
            color: white;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .close:hover {
            opacity: 0.7;
        }

        .modal-iframe {
            width: 100%;
            height: calc(100% - 60px);
            border: none;
        }

        @media (max-width: 768px) {
            .ai-tutor-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .ai-tutor-button {
                width: 200px;
            }
        }
    </style>
</head>
<body>
    <!-- Moving Planets Background -->
    <div class="planet-container">
        <div class="planet planet1"></div>
        <div class="planet planet2"></div>
        <div class="planet planet3"></div>
        <div class="planet planet4"></div>
        <div class="planet planet5"></div>
        <div class="planet planet6"></div>
    </div>

    <!-- Butterfly Canvas Background -->
    <canvas class="butterfly-canvas" id="butterflyCanvas"></canvas>

    <div class="header">
        <div>
            <div class="name">Salokhiddin Makhmudov</div>
            <div class="id">2417956</div>
        </div>
        <div class="grade-box" id="gradeBox">
            <strong>📊 Grade:</strong>
            <div><span id="gradePercent">Loading...</span>%</div>
            <small><span id="earnedPoints">0</span> / <span id="totalPoints">0</span></small>
        </div>
    </div>

    <div class="container">
        <h2 class="section-title">Completed Assignments</h2>
        <div class="assignments">
            <div class="assignment-card">
                <h3>Assignment 1</h3>
                <span class="action-button">Coming Soon</span>
            </div>

            <div class="assignment-card">
                <h3>Assignment 2</h3>
                <div class="assignment-subtitle">CLI Dungeon Crawl</div>
                <div class="button-container">
                    <a href="Assignment2_Dungeon_Report.pdf" target="_blank" class="action-button">Open File</a>
                </div>
            </div>

            <div class="assignment-card">
                <h3>Assignment 3</h3>
                <div class="assignment-subtitle">Virtual Library</div>
                <div class="button-container">
                    <a href="report_week_4.pptx" target="_blank" class="action-button">Open Report</a>
                </div>
            </div>

            <div class="assignment-card">
                <h3>Assignment 4</h3>
                <div class="script-title">Week 7 AP Script</div>
                <div class="button-container">
                    <a href="https://docs.google.com/document/d/1m73vqyvNj2j3SFLPM8BTX0Id8Gst_APQ0dUcTu--Eac/edit?usp=sharing" target="_blank" class="action-button">Open Document</a>
                </div>
            </div>

            <div class="assignment-card">
                <h3>Assignment 5</h3>
                <div class="assignment-subtitle">Cryptography Project</div>
                <div class="button-container">
                    <a href="https://behruz1262.github.io/encryption-decryption-tool" target="_blank" class="action-button">Cryptography Tool</a>
                    <a href="documentation.html" target="_blank" class="action-button">Documentation</a>
                </div>
            </div>

            <div class="assignment-card">
                <h3>Week 10</h3>
                <div class="assignment-subtitle">Lumen Project</div>
                <div class="button-container">
                    <a href="lumenchat.html" target="_blank" class="action-button">Lumen Chat</a>
                    <a href="LumenReport.html" target="_blank" class="action-button">Lumen Report</a>
                    <button class="action-button chatgpt-button" onclick="window.open('https://chatgpt.com/share/684b1685-1ba4-8011-b441-195646444c05', '_blank')">
                        ChatGPT Chat History
                    </button>
                </div>
            </div>

            <!-- Week 16 Assignment Added -->
            <div class="assignment-card">
                <h3>Week 16</h3>
                <div class="assignment-subtitle">Take a Hike Project</div>
                <div class="button-container">
                    <button class="action-button" onclick="openModal('reportModal')">Report</button>
                    <button class="action-button" onclick="openModal('mapModal')">Map</button>
                </div>
            </div>
        </div>

        <h2 class="section-title">Upcoming Assignments</h2>
        <div class="assignments">
            <div class="assignment-card uncompleted">
                <h3>Week 13</h3>
                <div class="assignment-subtitle">Coming Soon</div>
                <div class="button-container">
                    <span class="action-button" style="background-color: #d4a017;">Not Available</span>
                </div>
            </div>
        </div>

        <!-- AI Tutor Section -->
        <div class="ai-tutor-section">
            <h2>🤖 AI Tutor</h2>
            <div class="ai-tutor-buttons">
                <button class="ai-tutor-button chatgpt-button" onclick="openModal('chatHistoryModal')">
                    💬 Chat History
                </button>
                <button class="ai-tutor-button reflection-button" onclick="openModal('reflectionModal')">
                    📝 Reflection
                </button>
            </div>
        </div>

        <div class="google-folder-container">
            <a href="https://drive.google.com/drive/folders/1-HYx9KJq4-fv4tCDuNt8IcESzneLJHLG" target="_blank" class="google-folder-button">
                My Google Folder
            </a>
        </div>

        <div class="animated-element"></div>
    </div>

    <!-- Modal for Report -->
    <div id="reportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Week 16 - Take a Hike Report</h2>
                <span class="close" onclick="closeModal('reportModal')">&times;</span>
            </div>
            <iframe id="reportFrame" class="modal-iframe" src=""></iframe>
        </div>
    </div>

    <!-- Modal for Map -->
    <div id="mapModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Week 16 - Project Map</h2>
                <span class="close" onclick="closeModal('mapModal')">&times;</span>
            </div>
            <iframe id="mapFrame" class="modal-iframe" src=""></iframe>
        </div>
    </div>

    <!-- Modal for Chat History -->
    <div id="chatHistoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>AI Tutor - Chat History</h2>
                <span class="close" onclick="closeModal('chatHistoryModal')">&times;</span>
            </div>
            <iframe id="chatHistoryFrame" class="modal-iframe" src=""></iframe>
        </div>
    </div>

    <!-- Modal for Reflection -->
    <div id="reflectionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>AI Tutor - Reflection</h2>
                <span class="close" onclick="closeModal('reflectionModal')">&times;</span>
            </div>
            <iframe id="reflectionFrame" class="modal-iframe" src=""></iframe>
        </div>
    </div>

    <script>
        // Butterfly Animation
        class Butterfly {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.reset();
                this.wingPhase = Math.random() * Math.PI * 2;
                this.colors = [
                    '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', 
                    '#ffeaa7', '#dda0dd', '#98d8c8', '#f7dc6f'
                ];
                this.color = this.colors[Math.floor(Math.random() * this.colors.length)];
            }

            reset() {
                this.x = -50;
                this.y = Math.random() * this.canvas.height;
                this.baseY = this.y;
                this.speed = 0.5 + Math.random() * 1.5;
                this.size = 8 + Math.random() * 12;
                this.wingSpeed = 0.1 + Math.random() * 0.1;
                this.floatAmplitude = 20 + Math.random() * 30;
                this.floatSpeed = 0.02 + Math.random() * 0.02;
                this.time = 0;
            }

            update() {
                this.x += this.speed;
                this.time += this.floatSpeed;
                this.y = this.baseY + Math.sin(this.time) * this.floatAmplitude;
                this.wingPhase += this.wingSpeed;

                if (this.x > this.canvas.width + 50) {
                    this.reset();
                }
            }

            draw() {
                this.ctx.save();
                this.ctx.translate(this.x, this.y);
                
                // Butterfly body
                this.ctx.fillStyle = '#333';
                this.ctx.fillRect(-1, -this.size/2, 2, this.size);
                
                // Wing animation
                const wingFlap = Math.sin(this.wingPhase) * 0.3 + 0.7;
                
                // Left wings
                this.ctx.fillStyle = this.color;
                this.ctx.globalAlpha = 0.8;
                
                // Top left wing
                this.ctx.save();
                this.ctx.scale(-wingFlap, 1);
                this.ctx.beginPath();
                this.ctx.ellipse(-this.size/2, -this.size/3, this.size/2, this.size/3, 0, 0, Math.PI * 2);
                this.ctx.fill();
                this.ctx.restore();
                
                // Bottom left wing
                this.ctx.save();
                this.ctx.scale(-wingFlap, 1);
                this.ctx.beginPath();
                this.ctx.ellipse(-this.size/3, this.size/4, this.size/3, this.size/4, 0, 0, Math.PI * 2);
                this.ctx.fill();
                this.ctx.restore();
                
                // Right wings
                this.ctx.save();
                this.ctx.scale(wingFlap, 1);
                this.ctx.beginPath();
                this.ctx.ellipse(this.size/2, -this.size/3, this.size/2, this.size/3, 0, 0, Math.PI * 2);
                this.ctx.fill();
                this.ctx.restore();
                
                this.ctx.save();
                this.ctx.scale(wingFlap, 1);
                this.ctx.beginPath();
                this.ctx.ellipse(this.size/3, this.size/4, this.size/3, this.size/4, 0, 0, Math.PI * 2);
                this.ctx.fill();
                this.ctx.restore();
                
                this.ctx.restore();
            }
        }

        // Initialize Butterfly Animation
        const butterflyCanvas = document.getElementById('butterflyCanvas');
        const butterflyCtx = butterflyCanvas.getContext('2d');
        const butterflies = [];

        function resizeButterflyCanvas() {
            butterflyCanvas.width = window.innerWidth;
            butterflyCanvas.height = window.innerHeight;
        }

        function initButterflies() {
            butterflies.length = 0;
            const numButterflies = Math.floor(window.innerWidth / 200) + 3;
            for (let i = 0; i < numButterflies; i++) {
                setTimeout(() => {
                    butterflies.push(new Butterfly(butterflyCanvas));
                }, i * 2000);
            }
        }

        function animateButterflies() {
            butterflyCtx.clearRect(0, 0, butterflyCanvas.width, butterflyCanvas.height);
            
            butterflies.forEach(butterfly => {
                butterfly.update();
                butterfly.draw();
            });
            
            requestAnimationFrame(animateButterflies);
        }

        // Initialize butterfly animation
        resizeButterflyCanvas();
        initButterflies();
        animateButterflies();

        window.addEventListener('resize', () => {
            resizeButterflyCanvas();
            initButterflies();
        });

        document.querySelectorAll('.assignment-card').forEach(card => {
            card.addEventListener('click', function(e) {
                if (e.target !== this && (e.target.tagName === 'A' || e.target.className.includes('action-button') || e.target.tagName === 'BUTTON')) return;
                this.style.backgroundColor = '#e8f5e9';
                setTimeout(() => {
                    this.style.backgroundColor = this.classList.contains('uncompleted') ? '#fff8e6' : '#f9f9f9';
                }, 300);
            });
        });

        // Grade fetch
        fetch("https://script.google.com/macros/s/AKfycbwj-BXuRBsF6Ha4fT4u2VeRYBayijTAmyUE_VPMq-4R-WEqJe52pXIe4jUtnlsCDPkP/exec")
            .then(res => res.json())
            .then(data => {
                document.getElementById("gradePercent").textContent = data.currentPercentage;
                document.getElementById("earnedPoints").textContent = data.earnedPoints;
                document.getElementById("totalPoints").textContent = data.totalPossiblePoints;
            })
            .catch(() => {
                document.getElementById("gradeBox").innerHTML = "<span style='color:red;'>Grade load failed</span>";
            });

        // Modal functions
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'block';
            
            if (modalId === 'reportModal') {
                document.getElementById('reportFrame').src = 'https://normanaffleck.github.io/IBM/DI/Take_a_hike.html';
            } else if (modalId === 'mapModal') {
                document.getElementById('mapFrame').src = 'https://drive.google.com/file/d/1lyDnpiJNKUzlQujuFeAIQOAetIH6Kk2Z/preview';
            } else if (modalId === 'chatHistoryModal') {
                document.getElementById('chatHistoryFrame').src = 'https://chatgpt.com/share/684b31a6-cf44-8011-9f2b-4fadd0f549b7';
            } else if (modalId === 'reflectionModal') {
                document.getElementById('reflectionFrame').src = 'https://docs.google.com/document/d/1uyeeyjxluSMmpDoyk1qlhDEpTeXgYzE-k3d-1FFDa-E/edit?usp=drivesdk';
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'none';
            
            // Clear iframe src to stop loading
            if (modalId === 'reportModal') {
                document.getElementById('reportFrame').src = '';
            } else if (modalId === 'mapModal') {
                document.getElementById('mapFrame').src = '';
            } else if (modalId === 'chatHistoryModal') {
                document.getElementById('chatHistoryFrame').src = '';
            } else if (modalId === 'reflectionModal') {
                document.getElementById('reflectionFrame').src = '';
            }
        }

        // Close modal when clicking outside of it
        window.onclick = function(event) {
            const modals = ['reportModal', 'mapModal', 'chatHistoryModal', 'reflectionModal'];
            
            modals.forEach(modalId => {
                const modal = document.getElementById(
